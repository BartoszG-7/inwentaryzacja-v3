<div class="container right-project-container">
  <div class="header-row">
    <div class="header-left">
      <button
        type="button"
        class="back-arrow-btn"
        (click)="goToInwentaryzacja()"
        aria-label="PowrÃ³t do inwentaryzacji"
      >
        <i class="bi bi-arrow-90deg-left"></i>
      </button>
      <span class="header-title">{{ project.name }}</span>
    </div>
    <div class="header-actions">
      <app-search-bar
        [noPaddingBottom]="true"
        [showFilterModal]="true"
      ></app-search-bar>
      <button class="header-btn">SKANUJ</button>
      <app-edit-projekt [data]="project"></app-edit-projekt>
      <!--edit-->
      <app-dodaj-modal-device
        [projectId]="selectedId()"
        (refresh)="onRefresh($event)"
      ></app-dodaj-modal-device>
      <app-usun-modal-device
        (refresh)="onRefresh($event)"
        [projectId]="selectedId()"
        [markedDelete]="markedDelete"
      ></app-usun-modal-device>
    </div>
  </div>
  <div class="table-responsive right-table-responsive">
    <table
      class="table table-dark table-bordered table-hover align-middle mb-0 right-project-table stickyhead"
    >
      <colgroup>
        <col id="checkbox" />
        <col id="snWama" />
        <col id="snProd" />
        <col id="mac" />
        <col id="ip" />
        <col id="gateway" />
        <col id="mask" />
        <col id="anydesk" />
        <col id="dns1" />
        <col id="dns2" />
        <col id="server" />
        <col id="edit" />
      </colgroup>
      <thead>
        <tr>
          <th style="width: 32px"></th>
          <th style="width: 110px" (click)="toggleHeader('snWamasoft')" [class.header-active]="isHeaderActive('snWamasoft')">SN WAMASOFT <i *ngIf="isHeaderActive('snWamasoft') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('snWamasoft') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 110px" (click)="toggleHeader('snProducenta')" [class.header-active]="isHeaderActive('snProducenta')">SN PRODUCENTA <i *ngIf="isHeaderActive('snProducenta') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('snProducenta') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('mac')" [class.header-active]="isHeaderActive('mac')">MAC <i *ngIf="isHeaderActive('mac') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('mac') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('ip')" [class.header-active]="isHeaderActive('ip')">IP <i *ngIf="isHeaderActive('ip') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('ip') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('brama')" [class.header-active]="isHeaderActive('brama')">BRAMA <i *ngIf="isHeaderActive('brama') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('brama') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('maska')" [class.header-active]="isHeaderActive('maska')">MASKA <i *ngIf="isHeaderActive('maska') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('maska') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('anydesk')" [class.header-active]="isHeaderActive('anydesk')">ANYDESK <i *ngIf="isHeaderActive('anydesk') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('anydesk') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('dns1')" [class.header-active]="isHeaderActive('dns1')">DNS1 <i *ngIf="isHeaderActive('dns1') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('dns1') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('dns2')" [class.header-active]="isHeaderActive('dns2')">DNS2 <i *ngIf="isHeaderActive('dns2') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('dns2') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px" (click)="toggleHeader('serwer')" [class.header-active]="isHeaderActive('serwer')">SERWER <i *ngIf="isHeaderActive('serwer') && activeSortDirection==='desc'" class="bi bi-arrow-down"></i><i *ngIf="isHeaderActive('serwer') && activeSortDirection==='asc'" class="bi bi-arrow-up"></i></th>
          <th style="width: 90px"></th>
        </tr>
      </thead>
    </table>
    <table
      class="table table-dark table-bordered table-hover align-middle mb-0 right-project-table"
    >
      <colgroup>
        <col id="checkbox" />
        <col id="snWama" />
        <col id="snProd" />
        <col id="mac" />
        <col id="ip" />
        <col id="gateway" />
        <col id="mask" />
        <col id="anydesk" />
        <col id="dns1" />
        <col id="dns2" />
        <col id="server" />
        <col id="edit" />
      </colgroup>
      <tbody>
        <tr class="group-gap-row">
          <td colspan="12"></td>
        </tr>
        <ng-container *ngFor="let group of groupedRows; let i = index">
          <tr class="group-label-row">
            <td colspan="12" class="fw-bold text-uppercase">
              {{ group.name }}
            </td>
          </tr>
          <tr class="group-gap-row group-gap-row-after-header">
            <td colspan="12"></td>
          </tr>
          <tr *ngFor="let row of group.rows">
            <td>
              <input
                type="checkbox"
                id="{{ row.id }}"
                (change)="checkboxChanged($event)"
              />
            </td>
            <td (dblclick)="copyCell(row.snWamasoft)">
              {{ row.snWamasoft }}
            </td>
            <td (dblclick)="copyCell(row.snProducenta)">
              {{ row.snProducenta }}
            </td>
            <td (dblclick)="copyCell(row.mac)">
              {{ row.mac }}
            </td>
            <td (dblclick)="copyCell(row.ip)">
              {{ row.ip }}
            </td>
            <td (dblclick)="copyCell(row.brama)">
              {{ row.brama }}
            </td>
            <td (dblclick)="copyCell(row.maska)">
              {{ row.maska }}
            </td>
            <td (dblclick)="copyCell(row.anydesk)">
              {{ row.anydesk }}
            </td>
            <td (dblclick)="copyCell(row.dns1)">
              {{ row.dns1 }}
            </td>
            <td (dblclick)="copyCell(row.dns2)">
              {{ row.dns2 }}
            </td>
            <td (dblclick)="copyCell(row.serwer)">
              {{ row.serwer }}
            </td>
            <td class="text-end">
              <button class="header-btn btn-edit-row">
                <i class="bi bi-pencil"></i> Edytuj
              </button>
            </td>
          </tr>
          @if (i < groupedRows.length - 1) {
          <tr class="group-gap-row">
            <td colspan="12"></td>
          </tr>
          }
        </ng-container>
      </tbody>
    </table>
  </div>
</div>
