<div class="container right-project-container">
  <div class="header-row">
    <div class="header-left">
      <button
        type="button"
        class="back-arrow-btn"
        (click)="goToInwentaryzacja()"
        aria-label="PowrÃ³t do inwentaryzacji"
      >
        <i class="bi bi-arrow-90deg-left"></i>
      </button>
      <span class="header-title">{{ (project ?? { name: "" }).name }}</span>
    </div>
    <div class="header-actions">
      <app-search-bar
        [noPaddingBottom]="true"
        [showFilterModal]="true"
        (searchInput)="searchNoSort($event)"
      ></app-search-bar>
      <button class="header-btn">SKANUJ</button>
      <app-edit-projekt [data]="project"></app-edit-projekt>
      <!--edit-->
      <app-dodaj-modal-device
        [projectId]="selectedId"
        (refresh)="onRefresh($event)"
      ></app-dodaj-modal-device>
      <app-usun-modal-device
        (refresh)="onRefresh($event)"
        [projectId]="selectedId()"
        [markedDelete]="markedDelete"
      ></app-usun-modal-device>
    </div>
  </div>
  <div class="table-responsive right-table-responsive">
    <table
      class="table table-dark table-bordered table-hover align-middle mb-0 right-project-table stickyhead"
    >
      <colgroup>
        <col id="checkbox" />
        <col id="snWama" />
        <col id="snProd" />
        <col id="mac" />
        <col id="ip" />
        <col id="gateway" />
        <col id="mask" />
        <col id="anydesk" />
        <col id="dns1" />
        <col id="dns2" />
        <col id="server" />
        <col id="edit" />
      </colgroup>
      <thead>
        <tr>
          <th style="width: 32px"></th>
          <th
            style="width: 110px"
            (click)="toggleHeader('wamaNr')"
            [class.header-active]="isHeaderActive('wamaNr')"
          >
            SN WAMA
            <i
              *ngIf="isHeaderActive('wamaNr') && activeSortDirection === 'desc'"
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('wamaNr') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 110px"
            (click)="toggleHeader('serialNr')"
            [class.header-active]="isHeaderActive('serialNr')"
          >
            SN PROD
            <i
              *ngIf="
                isHeaderActive('serialNr') && activeSortDirection === 'desc'
              "
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="
                isHeaderActive('serialNr') && activeSortDirection === 'asc'
              "
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('macAddr')"
            [class.header-active]="isHeaderActive('macAddr')"
          >
            MAC
            <i
              *ngIf="
                isHeaderActive('macAddr') && activeSortDirection === 'desc'
              "
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('macAddr') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('ip')"
            [class.header-active]="isHeaderActive('ip')"
          >
            IP
            <i
              *ngIf="isHeaderActive('ip') && activeSortDirection === 'desc'"
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('ip') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('gateway')"
            [class.header-active]="isHeaderActive('gateway')"
          >
            BRAMA
            <i
              *ngIf="
                isHeaderActive('gateway') && activeSortDirection === 'desc'
              "
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('gateway') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('mask')"
            [class.header-active]="isHeaderActive('mask')"
          >
            MASKA
            <i
              *ngIf="isHeaderActive('mask') && activeSortDirection === 'desc'"
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('mask') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('remoteAccessId')"
            [class.header-active]="isHeaderActive('remoteAccessId')"
          >
            ANYDESK
            <i
              *ngIf="
                isHeaderActive('remoteAccessId') &&
                activeSortDirection === 'desc'
              "
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="
                isHeaderActive('remoteAccessId') &&
                activeSortDirection === 'asc'
              "
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('dns1')"
            [class.header-active]="isHeaderActive('dns1')"
          >
            DNS1
            <i
              *ngIf="isHeaderActive('dns1') && activeSortDirection === 'desc'"
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('dns1') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('dns2')"
            [class.header-active]="isHeaderActive('dns2')"
          >
            DNS2
            <i
              *ngIf="isHeaderActive('dns2') && activeSortDirection === 'desc'"
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="isHeaderActive('dns2') && activeSortDirection === 'asc'"
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th
            style="width: 90px"
            (click)="toggleHeader('serverAddress')"
            [class.header-active]="isHeaderActive('serverAddress')"
          >
            SERWER
            <i
              *ngIf="
                isHeaderActive('serverAddress') &&
                activeSortDirection === 'desc'
              "
              class="bi bi-arrow-down"
            ></i
            ><i
              *ngIf="
                isHeaderActive('serverAddress') && activeSortDirection === 'asc'
              "
              class="bi bi-arrow-up"
            ></i>
          </th>
          <th style="width: 90px"></th>
        </tr>
      </thead>
    </table>
    <table
      class="table table-dark table-bordered table-hover align-middle mb-0 right-project-table"
    >
      <colgroup>
        <col id="checkbox" />
        <col id="snWama" />
        <col id="snProd" />
        <col id="mac" />
        <col id="ip" />
        <col id="gateway" />
        <col id="mask" />
        <col id="anydesk" />
        <col id="dns1" />
        <col id="dns2" />
        <col id="server" />
        <col id="edit" />
      </colgroup>
      <tbody>
        <tr class="group-gap-row">
          <td colspan="12"></td>
        </tr>
        <ng-container *ngFor="let group of groupedRows; let i = index">
          <tr class="group-label-row">
            <td colspan="12" class="fw-bold text-uppercase">
              {{ group.name }}
            </td>
          </tr>
          <tr class="group-gap-row group-gap-row-after-header">
            <td colspan="12"></td>
          </tr>
          <tr *ngFor="let row of group.rows">
            <td>
              <input
                type="checkbox"
                id="{{ row.id }}"
                (change)="checkboxChanged($event)"
              />
            </td>
            <td
              title="{{ row.snWamasoft }}"
              (dblclick)="copyCell(row.snWamasoft)"
            >
              {{ row.snWamasoft }}
            </td>
            <td
              title="{{ row.snProducenta }}"
              (dblclick)="copyCell(row.snProducenta)"
            >
              {{ row.snProducenta }}
            </td>
            <td title="{{ row.mac }}" (dblclick)="copyCell(row.mac)">
              {{ row.mac }}
            </td>
            <td title="{{ row.ip }}" (dblclick)="copyCell(row.ip)">
              {{ row.ip }}
            </td>
            <td title="{{ row.brama }}" (dblclick)="copyCell(row.brama)">
              {{ row.brama }}
            </td>
            <td title="{{ row.maska }}" (dblclick)="copyCell(row.maska)">
              {{ row.maska }}
            </td>
            <td title="{{ row.anydesk }}" (dblclick)="copyCell(row.anydesk)">
              {{ row.anydesk }}
            </td>
            <td title="{{ row.dns1 }}" (dblclick)="copyCell(row.dns1)">
              {{ row.dns1 }}
            </td>
            <td title="{{ row.dns2 }}" (dblclick)="copyCell(row.dns2)">
              {{ row.dns2 }}
            </td>
            <td title="{{ row.serwer }}" (dblclick)="copyCell(row.serwer)">
              {{ row.serwer }}
            </td>
            <td class="text-end">
              <button class="header-btn btn-edit-row">
                <i class="bi bi-pencil"></i> Edytuj
              </button>
            </td>
          </tr>
          @if (i < groupedRows.length - 1) {
          <tr class="group-gap-row">
            <td colspan="12"></td>
          </tr>
          }
        </ng-container>
      </tbody>
    </table>
  </div>
</div>
